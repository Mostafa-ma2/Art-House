@model IEnumerable<PostText>
@{
    ViewData["Title"] = "هنر خانه";
}

<div class="main-text-list col-md-8 col-sm-12">
    @foreach (var item in Model)
    {

        <div class="text-list">
            <div class="top-pro">
                <img src="~/ProfileImage/@item.Users.ProfileImg" alt="">
                <a asp-action="Index" asp-controller="Profile" asp-route-id="@item.UserId" id="name">@item.Users.UserName</a>
                @if (User.Identity.Name != item.Users.UserName || !User.Identity.IsAuthenticated)
                {
                    if (item.Users.UserInUsers.Count == 0)
                    {
                        <a onclick="AddUserConnection(this)" attr="@item.UserId" id="fallow">دنبال کنید</a>
                    }
                }
            </div>
            <div class="main-text">
                <h1 class="text-center" style="margin-top:10px">نام داستان : <span>@item.Name</span></h1>
                @if (item.Image != null)
                {
                    <img src="~/PostTextImages/@item.Image" alt="">
                }
                <p>
                    <span style="color:#1b1be1a6"> نوضیح :  </span>
                    @item.ShortText
                </p>
            </div>
            <div class="main-footer">
                <a asp-action="Index" asp-controller="Profile" asp-route-id="@item.UserId" id="nvisande"><span>نویسدنده :</span> @item.Users.UserName</a>
                <p><span>تاریخ ثبت :</span> @item.CreatedTime.ToPersianDateString()</p>
                <a href="#" id="bro">ادامه داستان</a>
                <a href="#" id="savepost">سیو کردن پست</a>
            </div>
        </div>
    }
    <div class="row text-center" style="justify-content: center;">
        <nav aria-label="Page navigation example">
            <ul class="pagination">
                <li class="page-item">
                    @if (ViewBag.PageID != 1)
                    {
                        var c = ViewBag.PageID - 1;
                        <a class="page-link" href="/Home/Index?pageid=@c" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    }
                </li>
                @for (var i = 1; i <= ViewBag.CountPage - 1; i++)
                {
                    <li class="@(((int)ViewBag.PageID == i) ? "page-item active" : "page-item"))"><a class="page-link" href="/Home/Index?pageid=@i">@i</a></li>

                }
                <li class="page-item">
                    @if (ViewBag.PageID != ViewBag.CountPage - 1)
                    {
                        var c = ViewBag.PageID + 1;
                        <a class="page-link" href="/Home/Index?pageid=@c" aria-label="Previous">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    }
                </li>
            </ul>
        </nav>
    </div>
</div>
@section Scripts{
    <script type="text/javascript">
        function AddUserConnection(obj) {
            var attr = obj.getAttribute("attr");
            $.ajax({
                type: "Post",
                url: "/Account/AddCommunicationWithUsers",
                data: { id: attr },
                success: function (result) {
                    debugger;
                    obj.innerHTML = "دنبال میکنید";
                    obj.style.color = "Green";
                }
            });
        }
    </script>
}